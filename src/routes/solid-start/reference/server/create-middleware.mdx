---
title: createMiddleware
---

`createMiddleware` returns a middleware specification that SolidStart uses to determine when middleware functions should run during the request lifecycle.

```ts
import { createMiddleware } from "@solidjs/start/middleware";

const middlewareSpec = createMiddleware({
	onRequest: (event) => {
		console.log("Request received:", event.request.url);
	},
	onBeforeResponse: (event) => {
		console.log("Sending response:", event.response.status);
	},
});
```

See [Middleware](/solid-start/advanced/middleware) to learn more.

## Types

### `createMiddleware`

```ts
import type {
	RequestMiddleware,
	ResponseMiddleware,
} from "@solidjs/start/middleware";

function createMiddleware(options: {
	onRequest?: RequestMiddleware | RequestMiddleware[] | undefined;
	onBeforeResponse?: ResponseMiddleware | ResponseMiddleware[] | undefined;
});
```

### `RequestMiddleware`

```ts
import type { FetchEvent } from "@solidjs/start/server";

type RequestMiddleware = (
	event: FetchEvent
) =>
	| Response
	| Promise<Response>
	| void
	| Promise<void>
	| Promise<void | Response>;
```

### `ResponseMiddleware`

```ts
import type { FetchEvent } from "@solidjs/start/server";

type ResponseMiddlewareResponseParam<T = any> = {
	body?: Awaited<T | Promise<T>>;
};

type ResponseMiddleware = (
	event: FetchEvent,
	response: ResponseMiddlewareResponseParam
) => Response | Promise<Response> | void | Promise<void>;
```

## Parameters

`createMiddleware` takes an object with the following keys:

- `onRequest` (optional): A function or an array of functions that intercept the request and run before the application processes it.
- `onBeforeResponse` (optional): A function or an array of functions that intercept the response and run after the application has processed the request but before the response is sent to the client.

## Returns

`createMiddleware` returns a middleware specification.
